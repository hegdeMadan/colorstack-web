{"ast":null,"code":"import _objectSpread from \"/home/madan/Documents/workspace/artwork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _readOnlyError from \"/home/madan/Documents/workspace/artwork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/readOnlyError\";\nimport _classCallCheck from \"/home/madan/Documents/workspace/artwork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/madan/Documents/workspace/artwork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/madan/Documents/workspace/artwork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/madan/Documents/workspace/artwork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/madan/Documents/workspace/artwork/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/madan/Documents/workspace/artwork/src/components/projects/projectActs/PostCredits.js\";\nimport React, { Component } from 'react'; // import { firestoreConnect } from 'react-redux-firebase'\n// import { compose } from 'redux'\n\nimport firebase from 'firebase/app';\nimport 'firebase/firestore';\nimport { connect } from 'react-redux';\nimport { createLike as _createLike, removeLike as _removeLike, updateLike as _updateLike } from '../../../store/actions/LikeActions';\nimport { addCollection as _addCollection } from '../../../store/actions/Collection';\n\nvar PostCerdits =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(PostCerdits, _Component);\n\n  function PostCerdits() {\n    var _this;\n\n    _classCallCheck(this, PostCerdits);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(PostCerdits).call(this));\n\n    _this.getCollection = function () {\n      var postId = _this.props.project.id;\n      var uid = _this.props.auth.uid;\n      var isActive = '';\n      var db = firebase.firestore();\n      var ref = db.collection('users').doc(uid).collection('collection').where(\"postId\", \"==\", postId);\n      return ref.get().then(function (documentSnapshots) {\n        documentSnapshots.forEach(function (doc) {\n          console.log(\"dc: \", doc.data());\n          isActive = (_readOnlyError(\"isActive\"), doc.data().isActive ? true : false);\n          console.log(\"tst: \", isActive);\n        });\n      }).then(function () {\n        _this.setState(function () {\n          return {\n            collection: {\n              isActive: isActive\n            }\n          };\n        }, function () {\n          console.log(\"actv: \", _this.state.collection);\n        });\n      });\n    };\n\n    _this.getData = function () {\n      var projectId = _this.props.project.id;\n      var authorId = _this.props.auth.uid;\n      var dataObj = {};\n      var db = firebase.firestore();\n      var ref = db.collection('projects').doc(projectId).collection('likes').where('likeFromId', '==', authorId);\n      return ref.get().then(function (documentSnapshots) {\n        documentSnapshots.forEach(function (doc) {\n          var id = doc.id ? doc.id : null; // console.log(`get: ${projectId}`, doc.data())\n\n          dataObj = _objectSpread({}, doc.data(), {\n            id: id\n          });\n        });\n      }).then(function () {\n        _this.setState({\n          like: _objectSpread({}, dataObj)\n        });\n      });\n    };\n\n    _this.handleLike = function (e) {\n      _this.clickCount++; // preventing double click event from executing\n\n      if (_this.clickCount === 1) {\n        _this.singleClickTimer = setTimeout(function () {\n          _this.clickCount = 0;\n          var likes = _this.props.likeCount;\n          console.log(_this.state);\n          var isExist = _this.state && _this.state.like && _this.state.like.likeFromId ? true : false;\n          var likeObj = _this.state.like;\n          var isLiked = likeObj && likeObj.isActive ? true : false;\n          console.log(\"like state: \", isExist);\n          isExist // if user ever liked this post\n          ? isLiked // if like is still active\n          ? _this.setState(function () {\n            return {\n              like: {\n                likeToPost: _this.props.project.id,\n                likeCount: likes,\n                id: likeObj.id\n              }\n            };\n          }, function () {\n            console.log(\"remove\", _this.state.like);\n\n            _this.props.removeLike(_this.state.like);\n\n            _this.getData().then(function () {\n              console.log(\"remove\", _this.state);\n            });\n          }) : _this.setState(function () {\n            return {\n              like: {\n                likeToPost: _this.props.project.id,\n                likeCount: likes,\n                id: _this.state.like.id\n              }\n            };\n          }, function () {\n            console.log(\"update\", _this.state.like);\n\n            _this.props.updateLike(_this.state.like);\n\n            _this.getData().then(function () {\n              console.log(\"update\", _this.state);\n            });\n          }) : _this.setState(function () {\n            return {\n              like: {\n                likeToPost: _this.props.project.id,\n                likeCount: likes,\n                isActive: true\n              }\n            };\n          }, function () {\n            console.log(\"create\", _this.state.like);\n            var like = _this.state && _this.state.like ? _this.state.like : null;\n\n            _this.props.createLike(like);\n\n            _this.getData().then(function () {\n              console.log(\"create\", _this.state);\n            });\n          });\n        }, 400);\n      }\n    };\n\n    _this.addCollection = function () {\n      var collectedCount = _this.props.collected + 1;\n      var activeStatus = _this.props.isActive ? false : true;\n\n      _this.setState(function () {\n        return {\n          imageUrl: _this.props.project.imageUrl,\n          postId: _this.props.project.id,\n          activeStatus: activeStatus,\n          collectedCount: collectedCount\n        };\n      }, function () {\n        _this.props.addCollection(_this.state);\n      });\n    };\n\n    _this.clickCount = 0;\n    _this.singleClickTimer = '';\n    _this.state = {};\n    return _this;\n  }\n\n  _createClass(PostCerdits, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount(props) {\n      this.getData(); // getting like data\n\n      this.getCollection(); // collection data\n    } // getting art collection list\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      var likeCount = this.props.likeCount;\n      var like = this.state.like;\n      var liked = like && like.isActive ? true : false; // console.log(\"state: \", this.state)\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"icons-wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"post-act\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.handleLike,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, liked ? React.createElement(\"i\", {\n        className: \"material-icons blue-text\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, \"thumb_up\") : React.createElement(\"i\", {\n        className: \"material-icons\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }, \"thumb_up\"))), React.createElement(\"span\", {\n        className: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"material-icons\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, \"send\")))), React.createElement(\"div\", {\n        className: \"save\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 200\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        onClick: this.addCollection,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        className: \"material-icons center\",\n        title: \"add to your collection\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, \"add_to_photos\"))))), likeCount ? React.createElement(\"div\", {\n        className: \"counts\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        className: \"like-count\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 213\n        },\n        __self: this\n      }, likeCount, \" likes\")) : null);\n    }\n  }]);\n\n  return PostCerdits;\n}(Component);\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    createLike: function createLike(like) {\n      return dispatch(_createLike(like));\n    },\n    removeLike: function removeLike(like) {\n      return dispatch(_removeLike(like));\n    },\n    updateLike: function updateLike(like) {\n      return dispatch(_updateLike(like));\n    },\n    addCollection: function addCollection(post) {\n      return dispatch(_addCollection(post));\n    }\n  };\n};\n\nexport default connect(null, mapDispatchToProps)(PostCerdits);","map":{"version":3,"sources":["/home/madan/Documents/workspace/artwork/src/components/projects/projectActs/PostCredits.js"],"names":["React","Component","firebase","connect","createLike","removeLike","updateLike","addCollection","PostCerdits","getCollection","postId","props","project","id","uid","auth","isActive","db","firestore","ref","collection","doc","where","get","then","documentSnapshots","forEach","console","log","data","setState","state","getData","projectId","authorId","dataObj","like","handleLike","e","clickCount","singleClickTimer","setTimeout","likes","likeCount","isExist","likeFromId","likeObj","isLiked","likeToPost","collectedCount","collected","activeStatus","imageUrl","liked","mapDispatchToProps","dispatch","post"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\n// import { firestoreConnect } from 'react-redux-firebase'\n// import { compose } from 'redux'\nimport firebase from 'firebase/app'\nimport 'firebase/firestore'\nimport { connect } from 'react-redux'\nimport { createLike, removeLike, updateLike } from '../../../store/actions/LikeActions'\nimport { addCollection } from '../../../store/actions/Collection'\n\nclass PostCerdits extends Component {\n  constructor() {\n    super()\n    this.clickCount = 0\n    this.singleClickTimer = ''\n    this.state = {}\n  }\n\n  componentWillMount(props) {\n    this.getData() // getting like data\n    this.getCollection() // collection data\n  }\n\n  // getting art collection list\n  getCollection = () => {\n    const postId = this.props.project.id\n    const { uid } = this.props.auth\n    const isActive = ''\n\n    const db = firebase.firestore()\n    const ref = db.collection('users').doc(uid)\n      .collection('collection')\n      .where(\"postId\", \"==\", postId)\n\n      return ref.get().then(documentSnapshots => {\n        documentSnapshots.forEach(doc => {\n          console.log(\"dc: \", doc.data())\n          isActive = doc.data().isActive ? true : false\n          console.log(\"tst: \", isActive)\n        })\n      }).then(() => {\n        this.setState(() => {\n          return{\n            collection: {\n              isActive\n            }\n          }\n        }, () => {\n          console.log(\"actv: \", this.state.collection)\n        })\n      })\n  }\n\n  // getting \"like\" data\n  getData = () => {\n    const projectId = this.props.project.id\n    const authorId = this.props.auth.uid\n    let dataObj = {}\n\n    const db = firebase.firestore()\n    const ref = db.collection('projects').doc(projectId)\n      .collection('likes')\n      .where('likeFromId', '==', authorId)\n\n    return ref.get().then((documentSnapshots) => {\n      documentSnapshots.forEach(doc => {\n        const id = doc.id ? doc.id : null\n        // console.log(`get: ${projectId}`, doc.data())\n\n        dataObj = {\n          ...doc.data(),\n          id: id\n        }\n      })\n    })\n    .then(() => {\n      this.setState({\n        like: {\n          ...dataObj\n        }\n      })\n    })\n  }\n\n  // incrementing like to the post\n  handleLike = (e) => {\n    this.clickCount++\n    // preventing double click event from executing\n    if(this.clickCount === 1) {\n      this.singleClickTimer = setTimeout(() => {\n        this.clickCount = 0;\n\n        let likes = this.props.likeCount\n        console.log(this.state)\n        let isExist = this.state && this.state.like && this.state.like.likeFromId ? true : false\n        let likeObj = this.state.like\n        let isLiked = likeObj && likeObj.isActive ? true : false\n        console.log(\"like state: \", isExist)\n\n\n        isExist // if user ever liked this post\n        ? isLiked // if like is still active\n          ? this.setState(() => {\n              return {\n                like: {\n                  likeToPost: this.props.project.id,\n                  likeCount: likes,\n                  id: likeObj.id\n                }\n              }\n            }, () => {\n              console.log(\"remove\", this.state.like)\n              this.props.removeLike(this.state.like)\n              this.getData()\n              .then(() => {\n                console.log(\"remove\", this.state)\n              })\n            })\n\n          : this.setState(() => {\n              return {\n                like: {\n                  likeToPost: this.props.project.id,\n                  likeCount: likes,\n                  id: this.state.like.id\n                }\n              }\n            }, () => {\n              console.log(\"update\", this.state.like)\n              this.props.updateLike(this.state.like)\n              this.getData()\n              .then(() => {\n                console.log(\"update\", this.state)\n              })\n            })\n\n        : this.setState(() => {\n            return {\n              like: {\n                likeToPost: this.props.project.id,\n                likeCount: likes,\n                isActive: true\n              }\n            }\n          }, () => {\n            console.log(\"create\", this.state.like)\n            let like = this.state && this.state.like ? this.state.like : null\n            this.props.createLike(like)\n            this.getData()\n            .then(() => {\n              console.log(\"create\", this.state)\n            })\n          })\n        }, 400)\n\n    }\n  } // end of getting \"like\" data\n\n\n  // collection actions\n  addCollection = () => {\n    let collectedCount = this.props.collected + 1\n    let activeStatus = this.props.isActive ? false : true\n\n    this.setState(() => {\n      return {\n        imageUrl: this.props.project.imageUrl,\n        postId: this.props.project.id,\n        activeStatus,\n        collectedCount\n      }\n    }, () => {\n      this.props.addCollection(this.state)\n    })\n  }\n\n  render() {\n    const { likeCount } = this.props\n    const { like } = this.state\n    const liked = like && like.isActive ? true : false\n    // console.log(\"state: \", this.state)\n\n    return(\n      <div>\n      <div className=\"icons-wrapper\">\n        <div className=\"post-act\">\n          <span className=\"\">\n            <button onClick={this.handleLike}>\n              {liked\n                ? <i className=\"material-icons blue-text\">thumb_up</i>\n                : <i className=\"material-icons\">thumb_up</i>}\n            </button>\n          </span>\n          <span className=\"\">\n          <button>\n            <i className=\"material-icons\">send</i>\n          </button>\n          </span>\n        </div>\n        <div className=\"save\">\n          <span className=\"\">\n            <button onClick={this.addCollection}>\n               <i className=\"material-icons center\"\n                    title=\"add to your collection\">\n                  add_to_photos\n                </i>\n            </button>\n          </span>\n        </div>\n      </div>\n        {likeCount\n          ?\n            <div className=\"counts\">\n              <span className=\"like-count\">\n                {likeCount} likes\n              </span>\n            </div>\n          : null\n        }\n      </div>\n    )\n  }\n}\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    createLike: (like) => dispatch(createLike(like)),\n    removeLike: (like) => dispatch(removeLike(like)),\n    updateLike: (like) => dispatch(updateLike(like)),\n    addCollection: (post) => dispatch(addCollection(post))\n  }\n}\n\n\nexport default connect(null, mapDispatchToProps)(PostCerdits)\n"]},"metadata":{},"sourceType":"module"}